import {rest} from 'msw';
import { setupServer } from 'msw/node';

// 5 days worth of APoDs
const mockApodData = [{"copyright":"CARA Project","date":"2021-12-25","explanation":"The tail of a comet streams across this three degree wide telescopic field of view captured under dark Namibian skies on December 21. In outburst only a few days ago and just reaching naked eye visibility Comet Leonard (C/2021 A1) is this year's brightest comet. Binoculars will make the diffuse comet easier to spot though, close to the western horizon after sunset. Details revealed in the sharp image show the comet's coma with a greenish tinge, and follow the interaction of the comet's ion tail with magnetic fields in the solar wind. After passing closest to Earth on December 12 and Venus on December 18, Comet Leonard is heading toward perihelion, its closest approach to the Sun on January 3rd. Appearing in late December's beautiful evening skies Comet Leonard has also become known as 2021's Christmas Comet.   Launch Update: James Webb Space Telescope","hdurl":"https://apod.nasa.gov/apod/image/2112/C2021A1_211221.jpg","media_type":"image","service_version":"v1","title":"The Tail of a Christmas Comet","url":"https://apod.nasa.gov/apod/image/2112/C2021A1_211221_1024.jpg"},{"date":"2021-12-26","explanation":"There's a big new telescope in space. This one, the James Webb Space Telescope (JWST), not only has a mirror over five times larger than Hubble's in area, but can see better in infrared light. The featured picture shows JWST high above the Earth just after being released by the upper stage of an Ariane V rocket, launched yesterday from French Guiana. Over the next month, JWST will move out near the Sun-Earth L2 point where it will co-orbit the Sun with the Earth. During this time and for the next five months, JWST will unravel its segmented mirror and an array of sophisticated scientific instruments -- and test them. If all goes well, JWST will start examining galaxies across the universe and planets orbiting stars across our Milky Way Galaxy in the summer of 2022.   APOD Gallery: Webb Space Telescope Launch","hdurl":"https://apod.nasa.gov/apod/image/2112/JwstLaunch_Arianespace_1920.jpg","media_type":"image","service_version":"v1","title":"James Webb Space Telescope over Earth","url":"https://apod.nasa.gov/apod/image/2112/JwstLaunch_Arianespace_1080.jpg"},{"copyright":"Matipon TangmatithamNARIT","date":"2021-12-27","explanation":"Which one of these two streaks is a comet? Although they both have comet-like features, the lower streak is the only real comet. This lower streak shows the coma and tail of Comet Leonard, a city-sized block of rocky ice that is passing through the inner Solar System as it continues its looping orbit around the Sun.  Comet Leonard has recently passed its closest to both the Earth and Venus and will round the Sun next week.  The comet, still visible to the unaided eye, has developed a long and changing tail in recent weeks.  In contrast, the upper streak is the launch plume of the Ariane V rocket that lifted the James Webb Space Telescope (JWST) off the Earth two days ago. The featured single-exposure image was taken from Thailand, and the foreground spire is atop a pagoda in Doi Inthanon National Park. JWST, NASA's largest and most powerful space telescope so far, will orbit the Sun near the Earth-Sun L2 point and is scheduled to start science observations in the summer of 2022.    Gallery: Comet Leonard 2021  Gallery: Webb Space Telescope Launch: 2021 December 25","hdurl":"https://apod.nasa.gov/apod/image/2112/CometJwst_Matipon_2048.jpg","media_type":"image","service_version":"v1","title":"Comet Leonard behind JWST Launch Plume","url":"https://apod.nasa.gov/apod/image/2112/CometJwst_Matipon_1080.jpg"},{"copyright":"H\u00e5kan Hammar Vemdalen Ski ResortSkiStar","date":"2021-12-28","explanation":"What's happened to the Sun?  Sometimes it looks like the Sun is being viewed through a giant  lens.  In the featured video, however, there are actually millions of tiny lenses: ice crystals.  Water may freeze in the  atmosphere into small, flat, six-sided, ice crystals.  As these crystals flutter to the ground, much time is spent with their faces flat and parallel to the ground.  An observer may find themselves in the same plane as many of the falling ice crystals near sunrise or sunset.  During this alignment, each crystal can act like a miniature lens, refracting sunlight into our view and creating phenomena like parhelia, the technical term for sundogs.  The featured video was taken in late 2017 on the side of a ski hill at the Vemdalen Ski Resort in central  Sweden. Visible in the center is the most direct image of the Sun, while two bright sundogs glow prominently from both the left and the right.  Also visible is the bright 22 degree halo -- as well as the rarer and much fainter 46 degree halo -- also created by sunlight refracting through atmospheric ice crystals.","media_type":"video","service_version":"v1","title":"Sun Halo over Sweden","url":"https://www.youtube.com/embed/2SnbMTQwDKM?rel=0"},{"date":"2021-12-29","explanation":"What and where are these large ovals? They are rotating storm clouds on Jupiter imaged last month by NASA's Juno spacecraft. In general, higher clouds are lighter in color, and the lightest clouds visible are the relatively small clouds that dot the lower oval. At 50 kilometers across, however, even these light clouds are not small.  They are so high up that they cast shadows on the swirling oval below. The featured image has been processed to enhance color and contrast. Large ovals are usually regions of high pressure that span over 1000 kilometers and can last for years. The largest oval on Jupiter is the Great Red Spot (not pictured), which has lasted for at least hundreds of years. Studying cloud dynamics on Jupiter with Juno images enables a better understanding of dangerous typhoons and hurricanes on Earth.   Follow APOD in English on: Facebook,  Instagram, Podcast, Reddit, or Twitter","hdurl":"https://apod.nasa.gov/apod/image/2112/JupiterStorms_JunoGill_1024.jpg","media_type":"image","service_version":"v1","title":"Giant Storms and High Clouds on Jupiter","url":"https://apod.nasa.gov/apod/image/2112/JupiterStorms_JunoGill_1024.jpg"},{"copyright":"Daniele Gasparri","date":"2021-12-30","explanation":"Comet Leonard, brightest comet of 2021, is at the lower left of these two panels captured on December 29 in dark Atacama desert skies. Heading for its perihelion on January 3 Comet Leonard's visible tail has grown. Stacked exposures with a wide angle lens (also displayed in a reversed B/W scheme for contrast), trace the complicated ion tail for an amazing 60 degrees, with bright Jupiter shining near the horizon at lower right. Material vaporizing from Comet Leonard's nucleus, a mass of dust, rock, and ices about 1 kilometer across, has produced the long tail of ionized gas fluorescing in the sunlight. Likely flares on the comet's nucleus and buffeting by magnetic fields and the solar wind in recent weeks have resulted in the tail's irregular pinched and twisted appearance. Still days from its closest approach to the Sun, Comet Leonard's activity should continue. The comet is south of the Solar System's ecliptic plane as it sweeps through the southern constellation Microscopium.","hdurl":"https://apod.nasa.gov/apod/image/2112/tail_gasparri_web.jpg","media_type":"image","service_version":"v1","title":"The Further Tail of Comet Leonard","url":"https://apod.nasa.gov/apod/image/2112/tail_gasparri_web1024.jpg"}];

const handlers = [
    
    rest.post('/api', async (req, res, ctx) => 
    {
        // No real way to simulate an error so we just choose a date and send an error status.
        // This is our server timeout one. 
        
        if(req.body.startDate === "1999/12/12") 
        {
            return res(ctx.status(500));
        }
        else if(req.body.startDate === "1997/11/11") // For testing custom error messages. 
        {
            return res(ctx.status(400), ctx.json( {msg: "Custom error."}));
        }
        
        return res(ctx.json(mockApodData));
    })
];


// This configures a request mocking server with the given request handlers.
export const server = setupServer(...handlers);